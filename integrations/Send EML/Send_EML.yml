commonfields:
  id: Send EML
  version: -1
vcShouldKeepItemLegacyProdMachine: false
name: Send EML
display: Send EML
category: Utilities
image: data:image/png;base64,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LWZiZWZlN2M1MmY1YyIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDphMmI1NDliOC03YmMxLTQyZDAtOGIwNi00ZDY0N2ZhMWIwODIiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxOGE5ZTA2OS01MTM2LTQ3ZDQtYmRkNy1jZjY4YjcyZWVjOTYiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJXaW5kb3dzIgogICBHSU1QOlRpbWVTdGFtcD0iMTY2NDY5NTUwNDg5MDM0MCIKICAgR0lNUDpWZXJzaW9uPSIyLjEwLjMyIgogICB0aWZmOk9yaWVudGF0aW9uPSIxIgogICB4bXA6Q3JlYXRvclRvb2w9IkdJTVAgMi4xMCIKICAgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMjoxMDowMlQxNjoyNTowNCswOTowMCIKICAgeG1wOk1vZGlmeURhdGU9IjIwMjI6MTA6MDJUMTY6MjU6MDQrMDk6MDAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo1MWQ3MDViMS0wYzhlLTQ1MGEtYWY3Ny1hODYwYTVlNWM3N2YiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoV2luZG93cykiCiAgICAgIHN0RXZ0OndoZW49IjIwMjItMDktMTlUMTI6NDg6NDgiLz4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiCiAgICAgIHN0RXZ0OmNoYW5nZWQ9Ii8iCiAgICAgIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6OTdkNDY1NDEtYWQ1Zi00OTk2LThhMjktYjQyNzE0OGQ1NDc0IgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJHaW1wIDIuMTAgKFdpbmRvd3MpIgogICAgICBzdEV2dDp3aGVuPSIyMDIyLTEwLTAyVDE2OjI1OjA0Ii8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pqpi7iwAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAANdMAADXTAQwhQ3cAAAAHdElNRQfmCgIHGQR1UvmRAAAFIUlEQVRo3t3abYxcVRkH8N8O0wIuL0FQm0g/kIoV1JC0+EFRz5ET+WAsmphoVAw1poBRhNRoUEC0JZpISa2VAkECiSKSaIKJCpjccm9oopFEU14a0aLUosUXCtW+sMW2fphnzaYp6+zOzM7uPsn9MnPvOfc/z3P+5/9/zoyUnEZwMi7EZ/B2jOKI2RlH8Ax+hDvwp6puDnX7cBsnBdAvoYW/4CWzN0ZwBj6Pd2A1Hu364ZLTxfh+ZHknvo37cSAGn01xGEsD5Pvjs3uxuqqb57rN8GVRJr/Gm3A5DuHuqm5emE1oS04pqvG92B5JeQ+W42fdjNHCBdiF67AGJ+AGrCs5LZ0lQEdLTquwAR/ET3FlVOKiuHQL+BS8jKdwa2T4d/go7iw5rRgy2DMjEWtxFm7EF/Aw9kyo1K5J63/ruaqb/SWnX0S5fBUXY0PJ6Vzcgn1V3RyZIaBtnBdAE57FVXiwqps9JacTpsMxraM/qOrmP/gDrohfcxTX4FtYUnI6bgbAnowPBCFlNLgEP67qZk8vYx+zFCKL/yo5rcfjUVIfxxLcWHLaUtXN2ACAjuD1+FQw8Uux166r6mZnP+ZoTfZlgPo5VgZBLMd3sbLkdMYASvht2IhrQ1x8Ddf0C2xXiz2y/XjJ6Wpswyqsw5tLTrdXdfNkH8CeghVBRufiAWyo6mZzv6uo1e2NVd38DTfjajyJT2N9yWlFlOJ0wS4OjliHxVgfQmLzIPihNZWbq7rZH6V9eaizHD/C6pLTqVME2io5Lcd3gn13x7r9elU3Tw+KEFtTfaCqm8NV3WzFlyMzp8Wau6nktKRLsMfjw/geLgoWXoV7e2XhvgOeAHwXbsel2BHbxl0lp3eVnBa+EguXnE6PPX4jXhssfBl+VdXNwUFvea1eHq7qZh8exCdC7i3DPfhYAJsIdiHeirtCFr6Ar+CLVd08W9XN4ZkQNO1eB4gXfaLkdGXI05XYhPNLTvfhxZhnWRDeEvwysrxlppRb3wBPZPGS09rQ4VfEdSn+HJ57Mf6KO0NI7BiGNm/3c7BYg/eUnLYFGZ2HU8Oc3I9H8FBVN//uYzNgeIAnAP9tyWkrXocTw18/X9XN3j5O83LI3h1T4aL2oEon1vauAY5/qOTUhCZ4buiAB+ikFkTV7K3q5kDJqRp6SQ84FkXfbW3J6Ymp7t2tOQi4rdNSvg8fKTmdNt8Bj7/3G6IpcW3J6exuDcxcBTwer8bnAvhF4annNWBYgPeFrbyq5HTSfAc8HufonJ5smsy1tXtRLdPcVj6Ld/awQ4zq9M6PFaeH7VxaclqDB442Je0QBwvj5mdmAPOyaOcs7EFOTtY5PR7n4zZsLDndgRfHTUpLp6G9CB8qOY3OEMO2e7iO63KOM3VOUG7GW8YJrR0m/t06rdFDJaeH0U8jvhdPVXVzYAjr+lX4JN6Ib5acqrbOUeP1Oh3D64Lm9/fRzTwWVvGPQyS0C6LEb2hXdTNWcvphvNCFOHsSUpgO4Kd1TvmGHduxuz3Bx24pOT2q05Rb0MeJDuL5IQI9oNMsvBWPtY+yXGNTsVpzIHYGaf0A/6zq5sgw3NIY9oWBn+4yOfH/6IaD+I1Ok7CZ6KiGAfhu1D2ovNfgG5PwzG6d87DrsePoJuHIXKvRktNZwfzH0sy/1+lz3/JK22B7nqzVMZ3Ti5uwebIe93wA/Hed5v+mqm62z8cWz8TYFln9Sbf/OGrP8RJeg61T+TfCXAR8UOcg7jb8Y6pnUv8Flj+wp52CdcoAAAAASUVORK5CYII=
description: Send an email via SMTP from .eml
configuration:
- display: Mail server hostname or IP address
  name: host
  type: 0
  required: true
- display: SMTP Port
  name: port
  defaultvalue: "25"
  type: 0
  required: true
- display: Credentials
  name: credentials
  type: 9
  required: false
- display: Fully Qualified Domain Name (FQDN) - used in EHLO
  name: fqdn
  type: 0
  required: false
- display: Connection Security
  name: tls
  defaultvalue: None
  type: 15
  required: false
  options:
  - None
  - STARTTLS
  - SSL/TLS
  additionalinfo: The connection security. The `SSL/TLS` first establishes a secure
    `SSL/TLS` connection and conducts SMTP over that connection, and STARTTLS starts
    with unencrypted SMTP and then switches to SSL/TLS to ensure security.
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: "false"
  type: 8
  required: false
script:
  script: |
    import json
    import ssl
    import time
    import smtplib
    import urllib3
    import traceback
    import email.parser
    import email.utils
    import email.header
    import email.message
    from typing import Any, Dict, Tuple, List, Optional


    urllib3.disable_warnings()


    ''' COMMAND FUNCTIONS '''


    class SmtpClient:
        """
        SMTP Client
        """
        @staticmethod
        def __get_user_pass(
                credentials: Optional[Dict[str, str]]) -> Tuple[Optional[str], Optional[str]]:
            if credentials:
                return (str(credentials.get('identifier', '')),
                        str(credentials.get('password', '')))
            return (None, None)

        def __init__(self, params: Dict[str, Any]):
            """
            Initialize the instance

            :param params: The parameters given for the instance
            """
            self.__insecure = argToBoolean(params.get('insecure', False))
            self.__smtphost = params['host']
            self.__smtpport = int(params.get('port', 25))
            self.__smtpuser, self.__smtppass = SmtpClient.__get_user_pass(params.get('credentials'))
            self.__fqdn = params.get('fqdn') or socket.getfqdn() or 'localhost'
            self.__tlsmode = str(params.get('tls', ''))

            self.__ssl_context = None
            if self.__tlsmode in ['SSL/TLS', 'STARTTLS'] and self.__insecure:
                self.__ssl_context = ssl.SSLContext(ssl.PROTOCOL_TLS_CLIENT)
                self.__ssl_context.check_hostname = False
                self.__ssl_context.verify_mode = ssl.CERT_NONE

        def __connect(self) -> smtplib.SMTP:
            """
            Connect the SMTP server

            :return: SMTP Connection.
            """
            if self.__tlsmode == 'SSL/TLS':
                return smtplib.SMTP_SSL(
                    self.__smtphost,
                    self.__smtpport,
                    local_hostname=self.__fqdn,
                    context=self.__ssl_context)
            else:
                return smtplib.SMTP(
                    self.__smtphost,
                    self.__smtpport,
                    local_hostname=self.__fqdn)

        def __get_email_address(self,
                                msg: email.message.Message,
                                names: List[str]) -> List[str]:
            """
            Retrieve email addresses corresponding to the field names

            :param msg: An email message
            :param names: A list of the field names
            :return: A list of email address.
            """
            return [a[1] for name in names for a in email.utils.getaddresses(msg.get_all(name, []))]

        def test_connect(self) -> str:
            """
            Test to connect to the SMTP server

            :return: 'ok'
            """
            with self.__connect() as smtp:
                smtp.quit()
                return 'ok'

        def send_eml(self,
                     eml_id: str,
                     sender: Optional[str],
                     recipients: List[str],
                     header: Optional[Dict[str, str]]):
            """
            Make en email from .eml, and send it

            :param eml_id: An entry ID of email
            :param sender: An email address of sender
            :param recipients: A list of email addresses of recipients
            :param header: Header fields to override the header of .eml
            """
            eml_file = demisto.getFilePath(eml_id)
            with open(eml_file['path'], 'r') as f:
                msg = email.parser.Parser().parse(f)

            if not sender:
                senders = self.__get_email_address(msg, ['Sender', 'From'])
                if not senders:
                    raise RuntimeError('Sender addresses is not found.')
                sender = senders[0]

            if not recipients:
                recipients = self.__get_email_address(msg, ['To', 'Cc', 'Bcc'])
                if not recipients:
                    raise RuntimeError('Recipient addresses is not found.')
                recipients = list(set(recipients))

            del msg['Bcc']
            del msg['Resent-Bcc']
            del msg['Date']
            msg['Date'] = email.utils.formatdate(time.mktime(datetime.now().timetuple()), usegmt=True)

            if header:
                for name, value in header.items():
                    msg[name] = value

            # Send an email
            with self.__connect() as smtp:
                smtp.send_message(msg, from_addr=sender, to_addrs=recipients)
                smtp.quit()


    def test_module() -> str:
        """
        Test the connectivity to the SMTP server

        :return: 'ok' if test passed, anything else will fail the test.
        :rtype: ``str``
        """
        smtp = SmtpClient(demisto.params())
        return smtp.test_connect()


    def send_eml_command(eml_id: str,
                         sender: Optional[str],
                         recipients: List[str],
                         header: Optional[Dict[str, str]]):
        """
        Make en email from .eml, and send it

        :param eml_id: An entry ID of email
        :param sender: An email address of sender
        :param recipients: A list of email addresses of recipients
        :param header: Header fields to override the header of .eml
        """
        smtp = SmtpClient(demisto.params())
        smtp.send_eml(eml_id, sender, recipients, header)
        demisto.results('Mail sent successfully')


    ''' MAIN FUNCTION '''


    def main() -> None:

        # if your Client class inherits from BaseClient, SSL verification is
        # handled out of the box by it, just pass ``verify_certificate`` to
        # the Client constructor
        demisto.debug(f'Command being called is {demisto.command()}')
        try:
            args = demisto.args()
            if demisto.command() == 'test-module':
                return_results(test_module())

            elif demisto.command() == 'send-eml':
                header = args.get('header')
                if (not isinstance(header, dict)) and (header is not None):
                    if not isinstance(header, str):
                        raise DemistoException('header must be dict, or str in JSON dict')
                    header = json.loads(header)
                    if not isinstance(header, dict):
                        raise DemistoException('header must be dict, or str in JSON dict')

                send_eml_command(eml_id=args['entryID'],
                                 sender=args.get('sender'),
                                 recipients=argToList(args.get('recipients', [])),
                                 header=header)

        # Log exceptions and return errors
        except Exception as e:
            demisto.error(traceback.format_exc())  # print the traceback
            return_error(
                f'Failed to execute {demisto.command()} command.\nError:\n{str(e)}')


    ''' ENTRY POINT '''

    if __name__ in ('__main__', '__builtin__', 'builtins'):
        main()
  type: python
  commands:
  - name: send-eml
    arguments:
    - name: entryID
      required: true
      description: An entry ID of .eml file for an email to be sent
    - name: sender
      description: An email address of sender
    - name: recipients
      description: A comma-separated list of email address of recipients
    - name: header
      description: Header fields that overrides the header of .eml (in JSON dictionary)
    description: Send an email
  dockerimage: demisto/python3:3.8.6.13358
  runonce: false
  subtype: python3
sourcemoduleid: SendEml
